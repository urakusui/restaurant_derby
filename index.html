<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>è£KUSUI presents ç‹å°†ãƒ€ãƒ¼ãƒ“ãƒ¼</title>
<style>
/* åŸºæœ¬è¨­å®š */
body { font-family: sans-serif; background: #f5f5f5; padding: 15px; margin: 0; color: #333; }
* { box-sizing: border-box; }

/* ç”»é¢ã®è¡¨ç¤ºãƒ»éè¡¨ç¤ºåˆ¶å¾¡ */
.hidden { display: none !important; }

/* ã‚«ãƒ¼ãƒ‰ã‚¹ã‚¿ã‚¤ãƒ« */
.box { background: #fff; padding: 20px; margin-bottom: 20px; border-radius: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); }

/* ãƒ˜ãƒƒãƒ€ãƒ¼ï¼ˆã‚¿ã‚¤ãƒˆãƒ«ã¨ï¼Ÿãƒœã‚¿ãƒ³ã‚’æ¨ªä¸¦ã³ï¼‰ */
.header-row {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 20px;
  border-bottom: 2px solid #eee;
  padding-bottom: 10px;
}
.header-row h2 { flex:1; margin:0; color:#B71C1C; }
.btn-help {
  width: 40px; height: 40px; border-radius:50%; background:#666; color:#fff;
  font-size:20px; font-weight:bold; border:none; cursor:pointer;
  display:flex; justify-content:center; align-items:center;
}

/* å…¥åŠ›ãƒ»ãƒœã‚¿ãƒ³å…±é€š */
input, button { width:100%; margin:8px 0; padding:12px; font-size:16px; border-radius:6px; border:1px solid #ccc; }
button { border:none; font-weight:bold; color:#fff; cursor:pointer; transition:opacity 0.2s; }
button:active { transform:scale(0.98); }

/* ãƒœã‚¿ãƒ³ã®è‰² */
.btn-main { background:#B71C1C; }
.btn-add { background:#2E7D32; }
.btn-back { background:#616161; }
.btn-del { background:#f44336; margin-left:10px; padding:5px 12px; font-size:14px; cursor:pointer; }

/* ãƒªã‚¹ãƒˆè¡¨ç¤º */
.list-area { margin:15px 0; max-height:300px; overflow-y:auto; }
.list-item { display:flex; justify-content:space-between; align-items:center; border-bottom:1px solid #eee; padding:10px 0; }

/* ãƒ¢ãƒ¼ãƒ€ãƒ« */
.modal-overlay {
  position: fixed; top:0; left:0; width:100%; height:100%;
  background: rgba(0,0,0,0.7); z-index:9999; display:flex; justify-content:center; align-items:center;
}
.modal-content {
  background:#fff; width:90%; max-width:450px; padding:25px; border-radius:10px;
}

/* å‡ºèµ°è¡¨ãƒ†ãƒ¼ãƒ–ãƒ« */
table { width:100%; border-collapse:collapse; margin-top:10px; }
th, td { border:1px solid #ccc; padding:10px; text-align:center; font-size:14px; }
th { background:#eee; }
/* æ ç•ªã”ã¨ã®è‰² */
.waku-1 { color:#000; } .waku-2 { background:#333; color:#fff; }
.waku-3 { background:#f44336; color:#fff; } .waku-4 { background:#2196f3; color:#fff; }
.waku-5 { background:#ffeb3b; color:#000; } .waku-6 { background:#4caf50; color:#fff; }
.waku-7 { background:#ff9800; color:#fff; } .waku-8 { background:#ffc0cb; color:#000; }
</style>
</head>
<body>

<!-- ãƒ˜ãƒ«ãƒ—ãƒ¢ãƒ¼ãƒ€ãƒ« -->
<div id="modal-help" class="modal-overlay hidden">
  <div class="modal-content">
    <h3>ğŸ“– éŠã³æ–¹</h3>
    <ul style="padding-left:20px; line-height:1.8;">
      <li><b>ãƒ¡ãƒ‹ãƒ¥ãƒ¼ç™»éŒ²ï¼š</b> 3å“ä»¥ä¸Šå…¥åŠ›ã€‚ï¼ˆæœ€å¤§8å“ï¼‰</li>
      <li><b>å‡ºèµ°è¡¨ï¼š</b> ã€Œå‡ºèµ°è¡¨ã‚’ç¢ºèªã€ã§ã‚ªãƒƒã‚ºè¡¨ç¤ºã€‚</li>
      <li><b>äºˆæƒ³ï¼š</b> å‚åŠ è€…ã‚’ç™»éŒ²ã—ã¦åˆ°ç€é †ã‚’äºˆæƒ³ã€‚</li>
      <li><b>çµæœï¼š</b> æ–™ç†ãŒå±Šã„ãŸé †ã«å…¥åŠ›ã—ã¦çµæœç™ºè¡¨ï¼</li>
    </ul>
    <button type="button" class="btn-main" onclick="toggleModal()">é–‰ã˜ã‚‹</button>
  </div>
</div>

<!-- ãƒ¡ãƒ‹ãƒ¥ãƒ¼ç™»éŒ²ç”»é¢ -->
<div id="screen-menu" class="box">
  <div class="header-row">
    <h2>ç‹å°†ãƒ€ãƒ¼ãƒ“ãƒ¼</h2>
    <button type="button" class="btn-help" onclick="toggleModal()">ï¼Ÿ</button>
  </div>

  <input id="shopName" placeholder="åº—èˆ—åï¼ˆä¾‹ï¼šå¤§é˜ªç‹å°†ï¼‰">
  <input id="menuName" placeholder="ãƒ¡ãƒ‹ãƒ¥ãƒ¼åï¼ˆä¾‹ï¼šé¤ƒå­ï¼‰">
  <button type="button" class="btn-add" onclick="addMenu()">ï¼‹ ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚’è¿½åŠ </button>
  
  <div id="menuList" class="list-area">
    <div style="color:#888; text-align:center;">ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚’è¿½åŠ ã—ã¦ãã ã•ã„</div>
  </div>
  
  <button type="button" class="btn-main" onclick="toRaceTable()">ğŸ å‡ºèµ°è¡¨ã‚’ç¢ºèª</button>
  <button type="button" class="btn-back" onclick="resetAll()">ğŸ—‘ï¸ æœ€åˆã‹ã‚‰ã‚„ã‚Šç›´ã™</button>
</div>

<!-- å‡ºèµ°è¡¨ç”»é¢ -->
<div id="screen-race" class="box hidden">
  <h3>ğŸ å‡ºèµ°è¡¨</h3>
  <div id="raceTableArea"></div>
  <button type="button" class="btn-add" style="margin-top:15px;" onclick="toPlayerReg()">å‚åŠ è€…ç™»éŒ²ã¸é€²ã‚€</button>
  <button type="button" class="btn-back" onclick="show('screen-menu')">ãƒ¡ãƒ‹ãƒ¥ãƒ¼ä¿®æ­£ã«æˆ»ã‚‹</button>
</div>

<script>
let menus = [];
let players = [];
let currentPlayerIndex = 0;

const $ = id => document.getElementById(id);

function show(screenId){
  ['screen-menu','screen-race','screen-player','screen-predict','screen-result','screen-ticket'].forEach(id=>{
    $(id).classList.add('hidden');
  });
  $(screenId).classList.remove('hidden');
  window.scrollTo(0,0);
}

function toggleModal(){
  $('modal-help').classList.toggle('hidden');
}

function addMenu(){
  const val = $('menuName').value.trim();
  if(!val) return;
  const odds = (Math.random()*8+1.1).toFixed(1);
  menus.push({name:val, odds:odds});
  $('menuName').value='';
  renderMenus();

  // â˜…ãƒ¡ãƒ‹ãƒ¥ãƒ¼ãŒ3å“ä»¥ä¸Šãªã‚‰è‡ªå‹•ã§å‡ºèµ°è¡¨ç”»é¢ã¸
  if(menus.length>=3) toRaceTable();
}

function renderMenus(){
  const list = $('menuList');
  if(menus.length===0){
    list.innerHTML='<div style="text-align:center; color:#888;">ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚’è¿½åŠ ã—ã¦ãã ã•ã„</div>';
    return;
  }
  // â˜…å‰Šé™¤ãƒœã‚¿ãƒ³ã¯å¿…ãšè¡¨ç¤ºâ˜…
  list.innerHTML = menus.map((m,i)=>`
    <div class="list-item">
      <span style="font-weight:bold;">${i+1}. ${m.name}</span>
      <button type="button" class="btn-del" onclick="removeMenu(${i})">å‰Šé™¤</button>
    </div>
  `).join('');
}

function removeMenu(index){
  menus.splice(index,1);
  renderMenus();
}

function toRaceTable(){
  if(menus.length<3) return alert("ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚’3ã¤ä»¥ä¸Šç™»éŒ²ã—ã¦ãã ã•ã„");
  let html = '<table><tr><th>æ </th><th>ãƒ¡ãƒ‹ãƒ¥ãƒ¼å</th><th>ã‚ªãƒƒã‚º</th></tr>';
  menus.forEach((m,i)=>{
    const waku = Math.min(8, Math.floor(i / Math.max(1, menus.length/8)) + 1);
    html+=`<tr><td class="waku-${waku}">${i+1}</td><td>${m.name}</td><td>${m.odds}å€</td></tr>`;
  });
  html+='</table>';
  $('raceTableArea').innerHTML = html;
  show('screen-race');
}

function resetAll(){
  if(!confirm("ãƒ‡ãƒ¼ã‚¿ã‚’ã™ã¹ã¦æ¶ˆã—ã¦æœ€åˆã‹ã‚‰æˆ»ã‚Šã¾ã™ã‹ï¼Ÿ")) return;
  menus=[];
  players=[];
  $('menuList').innerHTML='<div style="text-align:center; color:#888;">ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚’è¿½åŠ ã—ã¦ãã ã•ã„</div>';
  $('shopName').value='';
  $('menuName').value='';
  show('screen-menu');
}

function toPlayerReg(){ show('screen-player'); }
</script>

</body>
</html>
